<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unit Quiz âœ¿</title>
    <link rel="stylesheet" href="../style.css">
    <style>
        .hidden { display: none; }
        .show-answer {
            margin: 10px 0;
            padding: 5px 10px;
            background: #ff99cc;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        .show-answer:hover { background: #ff66aa; }
        .loading { color: #ff66aa; }
    </style>
</head>
<body>
    <div class="unit unit-3-honors">
        <h1>Unit Quiz</h1>

        <div class="key-concept">
            <h2>í™”ì´íŒ…! Let's Test Your Knowledge! â­ï¸</h2>
            <p>Ready to show what you've learned about cellular energetics~?</p>
        </div>

        <div id="quizContent">
            <p class="loading">Loading questions... ì ì‹œë§Œìš”~</p>
        </div>

        <div class="study-tips">
            <h3>ğŸ’• Quiz Tips</h3>
            <ul>
                <li>Read each question carefully</li>
                <li>Take your time - ì²œì²œíˆ!</li>
                <li>Review wrong answers</li>
                <li>You can do it! í•  ìˆ˜ ìˆì–´ìš”!</li>
            </ul>
        </div>
    </div>

    <script>
        const xmlFiles = Array.from({length: 40}, (_, i) => `p${i + 1}.xml`);

        let allQuestions = [];

        async function loadQuizData() {
            try {
                const questionPromises = xmlFiles.map(file => 
                    fetch(file)
                        .then(response => response.text())
                        .then(str => new DOMParser().parseFromString(str, 'text/xml'))
                );

                const xmlDocs = await Promise.all(questionPromises);
                
                xmlDocs.forEach(doc => {
                    const questions = doc.getElementsByTagName('question');
                    Array.from(questions).forEach(q => {
                        allQuestions.push({
                            text: q.getElementsByTagName('text')[0].textContent,
                            options: Array.from(q.getElementsByTagName('option'))
                                        .map(opt => opt.textContent),
                            answer: q.getElementsByTagName('answer')[0].textContent,
                            explanation: q.getElementsByTagName('explanation')[0].textContent
                        });
                    });
                });

                displayQuiz();
            } catch (error) {
                console.error('Error loading quiz data:', error);
                document.getElementById('quizContent').innerHTML = 
                    '<p>ì•„ì´ê³ ... Error loading quiz. Please try again! ã… ã… </p>';
            }
        }

        function displayQuiz() {
            const quizHtml = allQuestions.map((q, index) => `
                <div class="practice">
                    <div class="question">
                        <p>${index + 1}. ${q.text}</p>
                        <ul>
                            ${q.options.map(opt => `<li>${opt}</li>`).join('')}
                        </ul>
                        <button class="show-answer">See Answer (â—•â€¿â—•âœ¿)</button>
                        <div class="answer hidden">
                            <p><strong>Answer:</strong> ${q.answer}</p>
                            <p><strong>Explanation:</strong> ${q.explanation}</p>
                        </div>
                    </div>
                </div>
            `).join('');

            document.getElementById('quizContent').innerHTML = quizHtml;

            document.querySelectorAll('.show-answer').forEach(button => {
                button.addEventListener('click', () => {
                    const answer = button.nextElementSibling;
                    answer.classList.toggle('hidden');
                    button.textContent = answer.classList.contains('hidden') ? 
                        'See Answer (â—•â€¿â—•âœ¿)' : 'Hide Answer (ï½¡â™¥â€¿â™¥ï½¡)';
                });
            });
        }

        window.addEventListener('load', loadQuizData);
    </script>
</body>
</html>